{% extends "base.html" %}

{% block title %}Message: {{ message_obj.subject|default:"(No subject)" }}{% endblock %}

{% block content %}
<div class="container">
  <p><a href="{% url 'glamp_messaging:inbox' %}" class="btn btn-link p-0">&larr; Back to inbox</a></p>

  <div class="card shadow-sm">
    <div class="card-header">
      <strong>{{ message_obj.subject|default:"(No subject)" }}</strong>
      <span class="text-muted float-end">
        {{ message_obj.sent_at|date:"Y-m-d H:i" }}
      </span>
    </div>
    <div class="card-body">
      <p class="mb-1"><strong>From:</strong>
        {{ message_obj.sender.email|default:message_obj.sender }}
      </p>
      <p class="mb-3"><strong>To:</strong>
        {{ message_obj.recipient.email|default:message_obj.recipient }}
      </p>
      <hr>
      <div style="white-space: pre-wrap;">
        {{ message_obj.body|default:"(no content)" }}
      </div>

      <hr>
      <form method="post" action="{% url 'glamp_messaging:delete_message' message_obj.id %}"
            onsubmit="return confirm('Delete this message? This cannot be undone.');">
        {% csrf_token %}
        <button type="submit" class="btn btn-outline-danger">Delete</button>
        <a href="{% url 'glamp_messaging:inbox' %}" class="btn btn-secondary ms-2">Cancel</a>
      </form>
    </div>
  </div>
</div>
{% endblock %}
